<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinician Dashboard - FlowPhysio</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, rgba(74, 144, 164, 0.2) 0%, rgba(43, 138, 174, 0.2) 50%, rgba(30, 107, 140, 0.2) 100%), url('backgrounddashboard.png');
            background-size: cover;
            background-position: center top;
            background-attachment: fixed;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><radialGradient id="grad1" cx="50%" cy="50%" r="50%"><stop offset="0%" style="stop-color:rgba(255,255,255,0.1);stop-opacity:1" /><stop offset="100%" style="stop-color:rgba(255,255,255,0);stop-opacity:0" /></radialGradient></defs><circle cx="20" cy="20" r="15" fill="url(%23grad1)"/><circle cx="80" cy="40" r="20" fill="url(%23grad1)"/><circle cx="60" cy="80" r="18" fill="url(%23grad1)"/></svg>') repeat;
            background-size: 200px 200px;
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .dashboard-header {
            background: linear-gradient(135deg, rgba(74, 144, 164, 0.95) 0%, rgba(43, 138, 174, 0.95) 50%, rgba(30, 107, 140, 0.95) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 15px 0;
            box-shadow: 0 4px 20px rgba(43, 138, 174, 0.08);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 40px;
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-logo img {
            height: 60px;
            width: auto;
            filter: brightness(1.2) drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
            mix-blend-mode: screen;
            opacity: 0.9;
            transition: all 0.3s ease;
        }

        .header-logo img:hover {
            transform: scale(1.05);
            filter: brightness(1.3) drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
            opacity: 1;
        }

        .header-title {
            color: white;
            font-size: 24px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);
        }

        .dashboard-content {
            max-width: 100vw;
            margin: 0 auto;
            padding: 30px 20px;
            display: grid;
            grid-template-columns: 40% 60%;
            gap: 20px;
            min-height: calc(100vh - 120px);
            position: relative;
            z-index: 1;
        }

        .left-column, .right-column {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .left-column::before, .right-column::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .left-column:hover::before, .right-column:hover::before {
            left: 100%;
        }

        .left-column:hover, .right-column:hover {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .section-title {
            color: white;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 50px;
            height: 2px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.3));
            border-radius: 1px;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.3);
        }

        .patient-info {
            margin-bottom: 30px;
        }

        .patient-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-label {
            color: white;
            font-weight: 600;
            font-size: 15px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .form-input {
            padding: 12px 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 15px;
            color: white;
            transition: all 0.3s ease;
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .ai-generator {
            margin-bottom: 30px;
        }

        .program-actions {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .save-program-btn {
            grid-column: span 3;
        }

        .email-btn {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.8), rgba(39, 174, 96, 0.8));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            flex: 1;
            justify-content: center;
        }

        .email-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.3);
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.9), rgba(39, 174, 96, 0.9));
        }

        .ai-input {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            font-family: 'Open Sans', sans-serif;
            font-size: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            resize: vertical;
            box-sizing: border-box;
            color: white;
        }

        .ai-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .ai-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .generate-btn, .print-btn, .add-btn, .remove-btn {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            color: #2B8AAE;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .generate-btn::before, .print-btn::before, .add-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .generate-btn:hover::before, .print-btn:hover::before, .add-btn:hover::before {
            left: 100%;
        }

        .generate-btn {
            width: 100%;
            margin-top: 15px;
        }

        .generate-btn:hover, .print-btn:hover, .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.2);
            background: linear-gradient(135deg, white, rgba(255, 255, 255, 0.9));
        }

        .print-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-btn {
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.8), rgba(200, 35, 51, 0.8));
            color: white;
            padding: 6px 12px;
            font-size: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .remove-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
            background: linear-gradient(135deg, rgba(220, 53, 69, 0.9), rgba(200, 35, 51, 0.9));
        }

        .program-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .program-table th {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .program-table td {
            padding: 10px 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }

        .program-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .program-table input {
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 6px 8px;
            font-size: 13px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            box-sizing: border-box;
            color: white;
            transition: all 0.3s ease;
        }

        .program-table input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .program-table input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
        }

        .week-header {
            background: rgba(255, 255, 255, 0.15);
            font-weight: 600;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .week-header td {
            position: relative;
        }

        .week-header td::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.2));
        }

        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .filter-group {
            flex: 1;
        }

        .filter-label {
            display: block;
            color: white;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .filter-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 15px;
            transition: all 0.3s ease;
            color: white;
        }

        .filter-select option {
            background: rgba(43, 138, 174, 0.9);
            color: white;
        }

        .filter-select:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        .search-container {
            margin-bottom: 20px;
        }

        .search-group {
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 15px;
            transition: all 0.3s ease;
            color: white;
            box-sizing: border-box;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .search-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .exercise-list {
            max-height: 500px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
        }

        .exercise-list::-webkit-scrollbar {
            width: 6px;
        }

        .exercise-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .exercise-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .exercise-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .exercise-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            max-height: 500px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
        }

        .exercise-grid::-webkit-scrollbar {
            width: 6px;
        }

        .exercise-grid::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .exercise-grid::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .exercise-grid::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .exercise-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            text-align: center;
        }

        .exercise-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .exercise-item:hover::before {
            left: 100%;
        }

        .exercise-item:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.1);
        }

        .exercise-image-placeholder {
            width: 100%;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
            font-size: 32px;
            position: relative;
            z-index: 1;
        }

        .exercise-name {
            font-weight: 600;
            color: white;
            font-size: 15px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 1;
            line-height: 1.3;
        }

        .patient-name-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .patient-details-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 36px;
            height: 36px;
        }

        .patient-details-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
        }

        .patient-details-btn.has-data {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.6), rgba(39, 174, 96, 0.6));
            border-color: rgba(46, 204, 113, 0.8);
        }

        .patient-details-btn.has-data:hover {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.8), rgba(39, 174, 96, 0.8));
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-header h3 {
            color: white;
            font-size: 20px;
            font-weight: 600;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: flex-end;
        }

        .form-select {
            padding: 12px 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 15px;
            color: white;
            transition: all 0.3s ease;
            width: 100%;
        }

        .form-select option {
            background: rgba(43, 138, 174, 0.9);
            color: white;
        }

        .form-select:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .form-textarea {
            padding: 12px 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 15px;
            color: white;
            transition: all 0.3s ease;
            resize: vertical;
            font-family: 'Open Sans', sans-serif;
            line-height: 1.5;
            width: 100%;
            box-sizing: border-box;
        }

        .form-textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-textarea:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .save-patient-btn {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.8), rgba(39, 174, 96, 0.8));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .save-patient-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.3);
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.9), rgba(39, 174, 96, 0.9));
        }

        .save-program-btn {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.8), rgba(41, 128, 185, 0.8));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .save-program-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(41, 128, 185, 0.9));
        }

        .patients-log-btn {
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.8), rgba(142, 68, 173, 0.8));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .patients-log-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(155, 89, 182, 0.3);
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.9), rgba(142, 68, 173, 0.9));
        }

        .large-modal {
            max-width: 1000px;
            width: 95%;
        }

        .log-body {
            max-height: 70vh;
            overflow-y: auto;
        }

        .log-filters {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .patients-log-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .log-entry {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .log-entry:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.1);
        }

        .log-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .log-patient-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .log-patient-name {
            color: white;
            font-size: 18px;
            font-weight: 600;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .log-patient-email {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .log-patient-condition {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 10px;
            border-radius: 12px;
            display: inline-block;
            margin-top: 5px;
        }

        .log-date {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            text-align: right;
        }

        .log-program {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .log-program-title {
            color: white;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .log-exercises {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .log-exercise {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 14px;
        }

        .log-exercise-name {
            color: white;
            font-weight: 500;
        }

        .log-exercise-details {
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
        }

        .log-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .load-program-btn, .delete-log-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .load-program-btn {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.7), rgba(41, 128, 185, 0.7));
            color: white;
        }

        .load-program-btn:hover {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(41, 128, 185, 0.9));
            transform: translateY(-1px);
        }

        .delete-log-btn {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.7), rgba(192, 57, 43, 0.7));
            color: white;
        }

        .delete-log-btn:hover {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.9), rgba(192, 57, 43, 0.9));
            transform: translateY(-1px);
        }

        .empty-log {
            text-align: center;
            padding: 40px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
        }

        .header-nav {
            display: flex;
            gap: 0;
        }

        .nav-tab {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border-radius: 0;
        }

        .nav-tab:first-child {
            border-radius: 8px 0 0 8px;
        }

        .nav-tab:last-child {
            border-radius: 0 8px 8px 0;
            border-left: none;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .nav-tab.active {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
        }

        .my-patients-view {
            max-width: 100vw;
            margin: 0 auto;
            padding: 30px 20px;
            min-height: calc(100vh - 120px);
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
        }

        .patients-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .patients-header {
            margin-bottom: 25px;
        }

        .patients-filters {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .program-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .template-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
        }

        .template-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
        }

        .template-modal {
            max-width: 1200px;
            width: 95%;
        }

        .template-body {
            max-height: 80vh;
            overflow-y: auto;
        }

        .template-subtitle {
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .template-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .template-card:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.1);
        }

        .template-card.selected {
            border-color: rgba(46, 204, 113, 0.8);
            background: rgba(46, 204, 113, 0.1);
        }

        .template-card.selected .template-checkmark {
            display: block;
        }

        .template-icon {
            font-size: 24px;
            margin-bottom: 12px;
        }

        .template-checkmark {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #2ecc71;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .template-card h4 {
            color: white;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .template-card p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .template-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .feature-tag {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .template-actions {
            display: flex;
            justify-content: center;
        }

        .apply-template-btn {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.8), rgba(39, 174, 96, 0.8));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .apply-template-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.3);
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.9), rgba(39, 174, 96, 0.9));
        }

        /* Post-Surgical Modal Styles */
        .post-surgical-modal {
            max-width: 900px;
            max-height: 95vh;
        }

        .post-surgical-body {
            padding: 24px;
            overflow-y: auto;
        }

        .surgery-info-header {
            background: linear-gradient(135deg, rgba(74, 144, 164, 0.3), rgba(43, 138, 174, 0.3));
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .info-field label {
            display: block;
            color: white;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 6px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .info-field input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 10px 12px;
            color: white;
            font-size: 14px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .info-field input:focus {
            outline: none;
            border-color: rgba(43, 138, 174, 0.8);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 3px rgba(43, 138, 174, 0.2);
        }

        .info-field input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .precautions-section {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .precautions-section h4 {
            color: #ff6b6b;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .precautions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
        }

        .precaution-item label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .precaution-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #ff6b6b;
        }

        .phase-section {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .phase-header {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.4), rgba(41, 128, 185, 0.4));
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .phase-header h4 {
            color: white;
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .phase-timeline {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-style: italic;
        }

        .phase-content {
            padding: 20px;
        }

        .exercise-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .exercise-info h5 {
            color: white;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .exercise-description {
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 12px;
        }

        .exercise-parameters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .param-group label {
            display: block;
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .param-group input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            padding: 6px 8px;
            color: white;
            font-size: 13px;
        }

        .clinical-notes h6,
        .monitoring-section h6 {
            color: white;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .clinical-notes ul {
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            line-height: 1.4;
            padding-left: 16px;
        }

        .clinical-notes li {
            margin-bottom: 4px;
        }

        .monitoring-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }

        .monitor-item label {
            display: block;
            color: rgba(255, 255, 255, 0.8);
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .monitor-item input,
        .monitor-item select {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            padding: 4px 6px;
            color: white;
            font-size: 12px;
        }

        .wound-care-section h5 {
            color: white;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .wound-checklist {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .check-item label {
            display: flex;
            align-items: center;
            gap: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            cursor: pointer;
        }

        .check-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #3498db;
        }

        .md-clearance,
        .action-required {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
        }

        .clearance-item label,
        .action-item label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #f39c12;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }

        .clearance-item input[type="checkbox"],
        .action-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #f39c12;
        }

        .phase-goals {
            margin-bottom: 20px;
        }

        .goal-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .goal-item label {
            color: white;
            font-weight: 600;
            min-width: 100px;
            font-size: 14px;
        }

        .progress-bar {
            flex: 1;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            border-radius: 12px;
            transition: width 0.3s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .post-surgical-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cancel-btn {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
        }

        .cancel-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        @media (max-width: 768px) {
            .dashboard-content {
                grid-template-columns: 1fr;
                padding: 20px;
                gap: 20px;
            }

            .header-content {
                padding: 0 20px;
                flex-direction: column;
                gap: 15px;
            }

            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="dashboard-header">
        <div class="header-content">
            <div class="header-logo">
                <img src="logo2.png" alt="FlowPhysio Logo">
                <div class="header-title">Clinician Dashboard</div>
            </div>
            <div class="header-nav">
                <button class="nav-tab active" onclick="showDashboard()">Dashboard</button>
                <button class="nav-tab" onclick="showMyPatients()">My Patients</button>
            </div>
            <div class="header-actions">
                <span class="user-info">Welcome, Dr. Admin</span>
                <a href="index.html" class="logout-btn">Logout</a>
            </div>
        </div>
    </header>

    <div class="dashboard-content" id="dashboardView">
        <!-- Left Column -->
        <div class="left-column">
            <!-- Patient Information Section -->
            <div class="patient-info">
                <h2 class="section-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
                        <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="7" r="4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Patient Information
                </h2>
                <div class="patient-form">
                    <div class="form-group">
                        <label class="form-label" for="patientName">Patient Name</label>
                        <div class="patient-name-container">
                            <input 
                                type="text" 
                                id="patientName" 
                                class="form-input" 
                                placeholder="Enter patient's full name..."
                            />
                            <button class="patient-details-btn" onclick="openPatientDetails()" title="Edit patient details">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M18.5 2.5C18.8978 2.10217 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10217 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10217 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Generator Section -->
            <div class="ai-generator">
                <h2 class="section-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
                        <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="white"/>
                        <circle cx="18" cy="6" r="2" fill="rgba(255,255,255,0.8)"/>
                        <circle cx="6" cy="18" r="2" fill="rgba(255,255,255,0.8)"/>
                    </svg>
                    AI Protocol Generator
                </h2>
                <textarea 
                    id="aiInput" 
                    class="ai-input" 
                    placeholder="Describe the patient condition, goals, and requirements for the rehabilitation program...&#10;&#10;Example: Patient with ACL reconstruction, 6 weeks post-surgery, athlete returning to soccer, needs strength and agility progression..."
                ></textarea>
                <button class="generate-btn" onclick="generateProgram()">Generate Program</button>
            </div>

            <!-- Training Program Section -->
            <div class="training-program">
                <div class="program-header">
                    <h2 class="section-title">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="white" stroke-width="2" fill="none"/>
                            <path d="M8 12L11 15L16 9" stroke="white" stroke-width="2" fill="none"/>
                            <circle cx="19" cy="5" r="2" fill="rgba(255,255,255,0.8)"/>
                        </svg>
                        Training Program
                    </h2>
                    <button class="template-btn" onclick="openTemplateSelector()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <rect x="3" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" fill="none"/>
                            <rect x="14" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" fill="none"/>
                            <rect x="3" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" fill="none"/>
                            <rect x="14" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                        Templates
                    </button>
                </div>
                <table class="program-table" id="programTable">
                    <thead>
                        <tr>
                            <th>Exercise</th>
                            <th>Sets × Reps</th>
                            <th>Notes</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="programBody">
                        <!-- Exercises will be added here -->
                    </tbody>
                </table>
                <div class="program-actions">
                    <button class="save-program-btn" onclick="saveProgram()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <path d="M19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16L21 8V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="17,21 17,13 7,13 7,21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="7,3 7,8 15,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Save Program
                    </button>
                    <button class="email-btn" onclick="emailProgram()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Email
                    </button>
                    <button class="print-btn" onclick="printProgram()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <polyline points="6,9 6,2 18,2 18,9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 18H4C2.9 18 2 17.1 2 16V11C2 9.9 2.9 9 4 9H20C21.1 9 22 9.9 22 11V16C22 17.1 21.1 18 20 18H18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="6,14 6,22 18,22 18,14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Print
                    </button>
                </div>
            </div>
        </div>

        <!-- Right Column -->
        <div class="right-column">
            <h2 class="section-title">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
                    <path d="M17 10L21 6L19 4L15 8V10H17Z" fill="white"/>
                    <path d="M7 14L3 18L5 20L9 16V14H7Z" fill="white"/>
                    <rect x="8" y="8" width="8" height="8" rx="1" fill="rgba(255,255,255,0.8)"/>
                    <circle cx="6" cy="6" r="2" fill="rgba(255,255,255,0.6)"/>
                    <circle cx="18" cy="18" r="2" fill="rgba(255,255,255,0.6)"/>
                </svg>
                Exercise Library
            </h2>
            
            <!-- Search and Filters -->
            <div class="search-container">
                <div class="search-group">
                    <label class="filter-label" for="searchInput">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <circle cx="11" cy="11" r="8" stroke="white" stroke-width="2"/>
                            <path d="m21 21-4.35-4.35" stroke="white" stroke-width="2"/>
                        </svg>
                        Search Exercises
                    </label>
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-input" 
                        placeholder="Search by exercise name..."
                        oninput="filterExercises()"
                    />
                </div>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label class="filter-label" for="bodyPartFilter">Body Part</label>
                    <select id="bodyPartFilter" class="filter-select" onchange="filterExercises()">
                        <option value="">All Body Parts</option>
                        <option value="shoulder">Shoulder</option>
                        <option value="knee">Knee</option>
                        <option value="ankle">Ankle</option>
                        <option value="hip">Hip</option>
                        <option value="spine">Spine</option>
                        <option value="elbow">Elbow</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label" for="typeFilter">Type</label>
                    <select id="typeFilter" class="filter-select" onchange="filterExercises()">
                        <option value="">All Types</option>
                        <option value="strength">Strength</option>
                        <option value="mobility">Mobility</option>
                        <option value="balance">Balance</option>
                        <option value="cardio">Cardio</option>
                        <option value="plyometric">Plyometric</option>
                    </select>
                </div>
            </div>

            <!-- Exercise List -->
            <div class="exercise-grid" id="exerciseList">
                <!-- Exercises will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- My Patients View -->
    <div class="my-patients-view" id="myPatientsView" style="display: none;">
        <div class="patients-container">
            <div class="patients-header">
                <h2 class="section-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
                        <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="16" y1="13" x2="8" y2="13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="16" y1="17" x2="8" y2="17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="10,9 9,9 8,9" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    My Patients
                </h2>
            </div>
            <div class="patients-filters">
                <div class="filter-group">
                    <label class="filter-label">Search Patients</label>
                    <input 
                        type="text" 
                        id="patientsSearchInput" 
                        class="search-input" 
                        placeholder="Search by patient name or condition..."
                        oninput="filterMyPatients()"
                    />
                </div>
                <div class="filter-group">
                    <label class="filter-label">Sort By</label>
                    <select id="patientsSortSelect" class="filter-select" onchange="sortMyPatients()">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="name-asc">Name A-Z</option>
                        <option value="name-desc">Name Z-A</option>
                    </select>
                </div>
            </div>
            <div class="patients-log-container" id="myPatientsContainer">
                <!-- Patient log entries will be populated here -->
            </div>
        </div>
    </div>

    <!-- Patient Details Modal -->
    <div id="patientModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Patient Details</h3>
                <button class="modal-close" onclick="closePatientDetails()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="modalPatientName">Patient Name</label>
                    <input 
                        type="text" 
                        id="modalPatientName" 
                        class="form-input" 
                        placeholder="Enter patient's full name..."
                    />
                </div>
                <div class="form-group">
                    <label class="form-label" for="modalPatientEmail">Email Address</label>
                    <input 
                        type="email" 
                        id="modalPatientEmail" 
                        class="form-input" 
                        placeholder="Enter patient's email address..."
                    />
                </div>
                <div class="form-group">
                    <label class="form-label" for="modalPatientCondition">Condition</label>
                    <select id="modalPatientCondition" class="form-select">
                        <option value="">Select condition...</option>
                        <option value="ACL Reconstruction">ACL Reconstruction</option>
                        <option value="Shoulder Impingement">Shoulder Impingement</option>
                        <option value="Lower Back Pain">Lower Back Pain</option>
                        <option value="Ankle Sprain">Ankle Sprain</option>
                        <option value="Tennis Elbow">Tennis Elbow</option>
                        <option value="Hip Replacement">Hip Replacement</option>
                        <option value="Meniscus Tear">Meniscus Tear</option>
                        <option value="Rotator Cuff Tear">Rotator Cuff Tear</option>
                        <option value="Plantar Fasciitis">Plantar Fasciitis</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="modalPatientNotes">Notes</label>
                    <textarea 
                        id="modalPatientNotes" 
                        class="form-textarea" 
                        placeholder="Add notes about the patient's condition, progress, or special considerations..."
                        rows="4"
                    ></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="save-patient-btn" onclick="savePatientDetails()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                        <path d="M19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16L21 8V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="17,21 17,13 7,13 7,21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="7,3 7,8 15,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Save Patient Details
                </button>
            </div>
        </div>
    </div>

    <!-- Template Selector Modal -->
    <div id="templateModal" class="modal-overlay" style="display: none;">
        <div class="modal-content template-modal">
            <div class="modal-header">
                <h3>Choose Your Program Template</h3>
                <button class="modal-close" onclick="closeTemplateSelector()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body template-body">
                <p class="template-subtitle">Select a template that best fits your patient's needs, or start from scratch</p>
                
                <div class="templates-grid">
                    <div class="template-card selected" onclick="selectTemplate('standard')">
                        <div class="template-icon">📋</div>
                        <div class="template-checkmark">✓</div>
                        <h4>Standard Rehab</h4>
                        <p>Comprehensive template with all essential tracking features. Perfect for most rehabilitation programs.</p>
                        <div class="template-features">
                            <span class="feature-tag">Pain Tracking</span>
                            <span class="feature-tag">ROM Measurements</span>
                            <span class="feature-tag">Progress Notes</span>
                            <span class="feature-tag">Weekly Goals</span>
                        </div>
                    </div>

                    <div class="template-card" onclick="selectTemplate('quick')">
                        <div class="template-icon">🎯</div>
                        <div class="template-checkmark">✓</div>
                        <h4>Quick Protocol</h4>
                        <p>Streamlined template focusing on exercises and basic progression. Ideal for straightforward cases.</p>
                        <div class="template-features">
                            <span class="feature-tag">Exercise Focus</span>
                            <span class="feature-tag">Simple Layout</span>
                            <span class="feature-tag">Basic Tracking</span>
                        </div>
                    </div>

                    <div class="template-card" onclick="selectTemplate('performance')">
                        <div class="template-icon">📊</div>
                        <div class="template-checkmark">✓</div>
                        <h4>Performance Tracking</h4>
                        <p>Advanced template with detailed metrics and outcome measures. Best for athletes and complex cases.</p>
                        <div class="template-features">
                            <span class="feature-tag">Strength Testing</span>
                            <span class="feature-tag">Functional Tests</span>
                            <span class="feature-tag">Graph Progress</span>
                            <span class="feature-tag">Detailed Analytics</span>
                        </div>
                    </div>

                    <div class="template-card" onclick="selectTemplate('home')">
                        <div class="template-icon">🏠</div>
                        <div class="template-checkmark">✓</div>
                        <h4>Home Exercise Program</h4>
                        <p>Patient-friendly template with clear instructions and visual guides. Optimized for home compliance.</p>
                        <div class="template-features">
                            <span class="feature-tag">Visual Guides</span>
                            <span class="feature-tag">Simple Language</span>
                            <span class="feature-tag">Daily Checklist</span>
                        </div>
                    </div>

                    <div class="template-card" onclick="selectTemplate('postsurgical')">
                        <div class="template-icon">🏥</div>
                        <div class="template-checkmark">✓</div>
                        <h4>Post-Surgical</h4>
                        <p>Specialized template with phase-based progression and surgical precautions. Includes red flags monitoring.</p>
                        <div class="template-features">
                            <span class="feature-tag">Phase Progression</span>
                            <span class="feature-tag">Precautions</span>
                            <span class="feature-tag">Wound Care</span>
                            <span class="feature-tag">MD Communication</span>
                        </div>
                    </div>

                    <div class="template-card" onclick="selectTemplate('custom')">
                        <div class="template-icon">✨</div>
                        <div class="template-checkmark">✓</div>
                        <h4>Custom Template</h4>
                        <p>Start with a blank slate and build your own template. Choose exactly what you need.</p>
                        <div class="template-features">
                            <span class="feature-tag">Fully Customizable</span>
                            <span class="feature-tag">Save as Template</span>
                        </div>
                    </div>
                </div>
                
                <div class="template-actions">
                    <button class="apply-template-btn" onclick="applyTemplate()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Apply Template
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Post-Surgical Template Form Modal -->
    <div id="postSurgicalModal" class="modal-overlay" style="display: none;">
        <div class="modal-content large-modal post-surgical-modal">
            <div class="modal-header">
                <h3>Post-Surgical Rehabilitation Protocol</h3>
                <button class="modal-close" onclick="closePostSurgicalForm()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body post-surgical-body">
                <!-- Surgery Information Header -->
                <div class="surgery-info-header">
                    <div class="info-grid">
                        <div class="info-field">
                            <label>Surgery:</label>
                            <input type="text" id="surgeryType" placeholder="e.g., ACL Reconstruction" />
                        </div>
                        <div class="info-field">
                            <label>Date:</label>
                            <input type="date" id="surgeryDate" />
                        </div>
                        <div class="info-field">
                            <label>Surgeon:</label>
                            <input type="text" id="surgeonName" placeholder="Dr. Smith" />
                        </div>
                        <div class="info-field">
                            <label>Graft Type:</label>
                            <input type="text" id="graftType" placeholder="e.g., Hamstring Autograft" />
                        </div>
                    </div>
                </div>

                <!-- Surgical Precautions -->
                <div class="precautions-section">
                    <h4>🚨 Surgical Precautions & Contraindications</h4>
                    <div class="precautions-grid">
                        <div class="precaution-item">
                            <label>
                                <input type="checkbox" checked />
                                No open chain exercises 0-12 weeks
                            </label>
                        </div>
                        <div class="precaution-item">
                            <label>
                                <input type="checkbox" checked />
                                Avoid pivot/cutting movements
                            </label>
                        </div>
                        <div class="precaution-item">
                            <label>
                                <input type="checkbox" checked />
                                Brace locked 0-30° weeks 0-2
                            </label>
                        </div>
                        <div class="precaution-item">
                            <label>
                                <input type="checkbox" checked />
                                Weight bearing as tolerated with crutches
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Phase 1: Protection -->
                <div class="phase-section phase-1">
                    <div class="phase-header">
                        <h4>Phase 1: Protection</h4>
                        <span class="phase-timeline">Weeks 1-2 • Gentle ROM</span>
                    </div>
                    
                    <div class="phase-content">
                        <div class="exercise-section">
                            <div class="exercise-item">
                                <div class="exercise-info">
                                    <h5>Heel Slides</h5>
                                    <p class="exercise-description">Supine, assist with towel<br>Goal: 0-90° by week 2</p>
                                </div>
                                <div class="exercise-parameters">
                                    <div class="param-group">
                                        <label>Sets × Reps</label>
                                        <input type="text" value="3 × 15 reps" />
                                    </div>
                                    <div class="param-group">
                                        <label>Frequency</label>
                                        <input type="text" value="Every 2 hours" />
                                    </div>
                                    <div class="param-group">
                                        <label>Pain Level</label>
                                        <input type="text" value="Pain < 3/10" />
                                    </div>
                                    <div class="param-group">
                                        <label>Hold Time</label>
                                        <input type="text" value="Hold 5 sec" />
                                    </div>
                                </div>
                                <div class="clinical-notes">
                                    <h6>Clinical Notes</h6>
                                    <ul>
                                        <li>Use towel for assistance</li>
                                        <li>Stop at first resistance</li>
                                        <li>Ice after exercise</li>
                                        <li>Document end-range achieved</li>
                                    </ul>
                                </div>
                                <div class="monitoring-section">
                                    <h6>Monitoring</h6>
                                    <div class="monitoring-grid">
                                        <div class="monitor-item">
                                            <label>Current ROM</label>
                                            <input type="text" placeholder="___°" />
                                        </div>
                                        <div class="monitor-item">
                                            <label>Pain Level</label>
                                            <input type="text" placeholder="___/10" />
                                        </div>
                                        <div class="monitor-item">
                                            <label>Swelling</label>
                                            <input type="text" placeholder="+___" />
                                        </div>
                                        <div class="monitor-item">
                                            <label>Quality</label>
                                            <select>
                                                <option value="">Select...</option>
                                                <option value="good">Good</option>
                                                <option value="fair">Fair</option>
                                                <option value="poor">Poor</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Wound Care & Monitoring -->
                        <div class="wound-care-section">
                            <h5>Wound Care & Monitoring</h5>
                            <div class="wound-checklist">
                                <div class="check-item">
                                    <label>
                                        <input type="checkbox" />
                                        Incision clean & dry
                                    </label>
                                </div>
                                <div class="check-item">
                                    <label>
                                        <input type="checkbox" />
                                        No excessive drainage
                                    </label>
                                </div>
                                <div class="check-item">
                                    <label>
                                        <input type="checkbox" />
                                        No increasing redness
                                    </label>
                                </div>
                                <div class="check-item">
                                    <label>
                                        <input type="checkbox" />
                                        Temperature < 100.4°F
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- MD Clearance -->
                        <div class="md-clearance">
                            <div class="clearance-item">
                                <label>
                                    <input type="checkbox" />
                                    MD Clearance Required: Progress to Phase 2 pending 2-week post-op appointment
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Phase 2: Early Mobility -->
                <div class="phase-section phase-2">
                    <div class="phase-header">
                        <h4>Phase 2: Early Mobility</h4>
                        <span class="phase-timeline">Weeks 3-6 • Progressive</span>
                    </div>
                    
                    <div class="phase-goals">
                        <div class="goal-item">
                            <label>ROM Goal</label>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%"></div>
                                <span class="progress-text">0-120°</span>
                            </div>
                        </div>
                        <div class="goal-item">
                            <label>Weight Bearing</label>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%"></div>
                                <span class="progress-text">75% BW</span>
                            </div>
                        </div>
                        <div class="goal-item">
                            <label>Quad Strength</label>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%"></div>
                                <span class="progress-text">3+/5</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-required">
                        <div class="action-item">
                            <label>
                                <input type="checkbox" />
                                Action Required: Schedule 6-week post-op appointment for Phase 3 clearance
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="post-surgical-actions">
                    <button class="apply-template-btn" onclick="applyPostSurgicalTemplate()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 5px;">
                            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Generate Protocol
                    </button>
                    <button class="cancel-btn" onclick="closePostSurgicalForm()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Patients Log Modal -->
    <div id="patientsLogModal" class="modal-overlay" style="display: none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>Patients Log</h3>
                <button class="modal-close" onclick="closePatientsLog()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body log-body">
                <div class="log-filters">
                    <div class="filter-group">
                        <label class="filter-label">Search Patients</label>
                        <input 
                            type="text" 
                            id="logSearchInput" 
                            class="search-input" 
                            placeholder="Search by patient name or condition..."
                            oninput="filterPatientsLog()"
                        />
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Sort By</label>
                        <select id="logSortSelect" class="filter-select" onchange="sortPatientsLog()">
                            <option value="date-desc">Newest First</option>
                            <option value="date-asc">Oldest First</option>
                            <option value="name-asc">Name A-Z</option>
                            <option value="name-desc">Name Z-A</option>
                        </select>
                    </div>
                </div>
                <div class="patients-log-container" id="patientsLogContainer">
                    <!-- Patient log entries will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Exercise database
        const exercises = [
            // Shoulder exercises
            { name: "Shoulder Press", bodyPart: "shoulder", type: "strength", defaultSets: "3", defaultReps: "12", emoji: "💪" },
            { name: "Lateral Raises", bodyPart: "shoulder", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🕊️" },
            { name: "External Rotation", bodyPart: "shoulder", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🔄" },
            { name: "Wall Angels", bodyPart: "shoulder", type: "mobility", defaultSets: "3", defaultReps: "12", emoji: "👼" },
            { name: "Pendulum Swings", bodyPart: "shoulder", type: "mobility", defaultSets: "2", defaultReps: "10", emoji: "⚖️" },
            { name: "Cross-Body Stretch", bodyPart: "shoulder", type: "mobility", defaultSets: "3", defaultReps: "30s", emoji: "🤲" },
            { name: "Scapular Squeezes", bodyPart: "shoulder", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🔥" },
            { name: "Arm Circles", bodyPart: "shoulder", type: "mobility", defaultSets: "2", defaultReps: "10", emoji: "⭕" },
            { name: "Wall Slides", bodyPart: "shoulder", type: "mobility", defaultSets: "3", defaultReps: "12", emoji: "🧱" },
            { name: "Band Pull-Aparts", bodyPart: "shoulder", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🎗️" },

            // Knee exercises
            { name: "Squats", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "12", emoji: "🏋️" },
            { name: "Lunges", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "10", emoji: "🚶" },
            { name: "Step-Ups", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "10", emoji: "🪜" },
            { name: "Wall Sits", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "30s", emoji: "🏠" },
            { name: "Leg Extensions", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🦵" },
            { name: "Hamstring Curls", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🔧" },
            { name: "Knee Flexion", bodyPart: "knee", type: "mobility", defaultSets: "3", defaultReps: "10", emoji: "📐" },
            { name: "Straight Leg Raises", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "📏" },
            { name: "Mini Squats", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "20", emoji: "⬇️" },
            { name: "Calf Raises", bodyPart: "knee", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🦵" },

            // Ankle exercises
            { name: "Heel Raises", bodyPart: "ankle", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "👠" },
            { name: "Ankle Circles", bodyPart: "ankle", type: "mobility", defaultSets: "2", defaultReps: "10", emoji: "⭕" },
            { name: "Calf Stretches", bodyPart: "ankle", type: "mobility", defaultSets: "3", defaultReps: "30s", emoji: "🧘" },
            { name: "Toe Raises", bodyPart: "ankle", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🦶" },
            { name: "Ankle Pumps", bodyPart: "ankle", type: "mobility", defaultSets: "3", defaultReps: "20", emoji: "⛽" },
            { name: "Single Leg Balance", bodyPart: "ankle", type: "balance", defaultSets: "3", defaultReps: "30s", emoji: "🤸" },
            { name: "Alphabet Writes", bodyPart: "ankle", type: "mobility", defaultSets: "2", defaultReps: "1 set", emoji: "✍️" },
            { name: "Resistance Band", bodyPart: "ankle", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🎗️" },
            { name: "Heel Walks", bodyPart: "ankle", type: "strength", defaultSets: "3", defaultReps: "20", emoji: "🚶" },
            { name: "Towel Scrunches", bodyPart: "ankle", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🧻" },

            // Hip exercises
            { name: "Hip Bridges", bodyPart: "hip", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🌉" },
            { name: "Clamshells", bodyPart: "hip", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🐚" },
            { name: "Fire Hydrants", bodyPart: "hip", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🔥" },
            { name: "Hip Flexor Stretch", bodyPart: "hip", type: "mobility", defaultSets: "3", defaultReps: "30s", emoji: "🧘" },
            { name: "Pigeon Pose", bodyPart: "hip", type: "mobility", defaultSets: "2", defaultReps: "60s", emoji: "🕊️" },
            { name: "Side-Lying Leg Lifts", bodyPart: "hip", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "📏" },
            { name: "Hip Circles", bodyPart: "hip", type: "mobility", defaultSets: "2", defaultReps: "10", emoji: "⭕" },
            { name: "Monster Walks", bodyPart: "hip", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "👹" },
            { name: "90/90 Stretch", bodyPart: "hip", type: "mobility", defaultSets: "2", defaultReps: "60s", emoji: "📐" },
            { name: "Glute Squeezes", bodyPart: "hip", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🍑" },

            // Spine exercises
            { name: "Cat-Cow Stretch", bodyPart: "spine", type: "mobility", defaultSets: "2", defaultReps: "10", emoji: "🐱" },
            { name: "Plank", bodyPart: "spine", type: "strength", defaultSets: "3", defaultReps: "30s", emoji: "🪵" },
            { name: "Bird Dog", bodyPart: "spine", type: "strength", defaultSets: "3", defaultReps: "10", emoji: "🐕" },
            { name: "Dead Bug", bodyPart: "spine", type: "strength", defaultSets: "3", defaultReps: "10", emoji: "🪲" },
            { name: "Knee to Chest", bodyPart: "spine", type: "mobility", defaultSets: "3", defaultReps: "30s", emoji: "🤲" },
            { name: "Spinal Twist", bodyPart: "spine", type: "mobility", defaultSets: "3", defaultReps: "10", emoji: "🌪️" },
            { name: "Superman", bodyPart: "spine", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🦸" },
            { name: "Child's Pose", bodyPart: "spine", type: "mobility", defaultSets: "2", defaultReps: "60s", emoji: "👶" },
            { name: "Pelvic Tilts", bodyPart: "spine", type: "mobility", defaultSets: "3", defaultReps: "10", emoji: "⚖️" },
            { name: "Side Plank", bodyPart: "spine", type: "strength", defaultSets: "3", defaultReps: "20s", emoji: "📐" },

            // Elbow exercises
            { name: "Bicep Curls", bodyPart: "elbow", type: "strength", defaultSets: "3", defaultReps: "12", emoji: "💪" },
            { name: "Tricep Extensions", bodyPart: "elbow", type: "strength", defaultSets: "3", defaultReps: "12", emoji: "🔧" },
            { name: "Wrist Curls", bodyPart: "elbow", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🌀" },
            { name: "Forearm Stretch", bodyPart: "elbow", type: "mobility", defaultSets: "3", defaultReps: "30s", emoji: "🤲" },
            { name: "Elbow Flexion", bodyPart: "elbow", type: "mobility", defaultSets: "3", defaultReps: "10", emoji: "📐" },
            { name: "Hammer Curls", bodyPart: "elbow", type: "strength", defaultSets: "3", defaultReps: "12", emoji: "🔨" },
            { name: "Tennis Ball Squeeze", bodyPart: "elbow", type: "strength", defaultSets: "3", defaultReps: "15", emoji: "🎾" },
            { name: "Pronation/Supination", bodyPart: "elbow", type: "mobility", defaultSets: "3", defaultReps: "10", emoji: "🔄" },
            { name: "Wall Push-Ups", bodyPart: "elbow", type: "strength", defaultSets: "3", defaultReps: "10", emoji: "🧱" },
            { name: "Nerve Glides", bodyPart: "elbow", type: "mobility", defaultSets: "3", defaultReps: "10", emoji: "⚡" }
        ];

        // Patient data storage
        let currentPatientData = {};
        let allPatientLogs = [];

        // Initialize the page
        function init() {
            displayExercises(exercises);
            loadPatientData();
            updatePatientButton();
            loadAllPatientLogs();
        }

        // Save program function
        function saveProgram() {
            const patientName = document.getElementById('patientName').value.trim();
            
            if (!patientName) {
                alert('Please enter a patient name before saving the program.');
                return;
            }

            const tbody = document.getElementById('programBody');
            const exerciseRows = tbody.querySelectorAll('tr');
            
            if (exerciseRows.length === 0) {
                alert('Please add exercises to the program before saving.');
                return;
            }

            // Get patient details if available
            const savedPatientData = localStorage.getItem(`patient_${patientName}`);
            let patientDetails = { name: patientName };
            if (savedPatientData) {
                patientDetails = JSON.parse(savedPatientData);
            }

            // Collect exercises
            const exercises = [];
            exerciseRows.forEach(row => {
                const exerciseName = row.cells[0].querySelector('input').value;
                const setsReps = row.cells[1].querySelector('input').value;
                const notes = row.cells[2].querySelector('input').value;
                
                exercises.push({
                    name: exerciseName,
                    setsReps: setsReps,
                    notes: notes
                });
            });

            // Create program log entry
            const programLog = {
                id: 'log_' + Date.now(),
                patient: patientDetails,
                exercises: exercises,
                createdDate: new Date().toISOString(),
                lastModified: new Date().toISOString()
            };

            // Save to localStorage
            localStorage.setItem(programLog.id, JSON.stringify(programLog));
            
            // Update logs list
            loadAllPatientLogs();
            
            alert('Program saved successfully!');
        }

        // Load all patient logs
        function loadAllPatientLogs() {
            allPatientLogs = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('log_')) {
                    const log = JSON.parse(localStorage.getItem(key));
                    allPatientLogs.push(log);
                }
            }
            allPatientLogs.sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate));
        }

        // Open patients log modal
        function openPatientsLog() {
            loadAllPatientLogs();
            displayPatientsLog();
            document.getElementById('patientsLogModal').style.display = 'flex';
        }

        // Close patients log modal
        function closePatientsLog() {
            document.getElementById('patientsLogModal').style.display = 'none';
        }

        // Display patients log
        function displayPatientsLog(logsToShow = allPatientLogs) {
            const container = document.getElementById('patientsLogContainer');
            
            if (logsToShow.length === 0) {
                container.innerHTML = '<div class="empty-log">No patient programs saved yet.</div>';
                return;
            }

            container.innerHTML = '';
            
            logsToShow.forEach(log => {
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                
                const exercisesHtml = log.exercises.map(exercise => `
                    <div class="log-exercise">
                        <span class="log-exercise-name">${exercise.name}</span>
                        <span class="log-exercise-details">${exercise.setsReps}${exercise.notes ? ' - ' + exercise.notes : ''}</span>
                    </div>
                `).join('');

                logEntry.innerHTML = `
                    <div class="log-entry-header">
                        <div class="log-patient-info">
                            <div class="log-patient-name">${log.patient.name}</div>
                            ${log.patient.email ? `<div class="log-patient-email">${log.patient.email}</div>` : ''}
                            ${log.patient.condition ? `<div class="log-patient-condition">${log.patient.condition}</div>` : ''}
                        </div>
                        <div class="log-date">
                            Created: ${new Date(log.createdDate).toLocaleDateString()}<br>
                            ${new Date(log.createdDate).toLocaleTimeString()}
                        </div>
                    </div>
                    <div class="log-program">
                        <div class="log-program-title">Rehabilitation Program (${log.exercises.length} exercises)</div>
                        <div class="log-exercises">
                            ${exercisesHtml}
                        </div>
                        <div class="log-actions">
                            <button class="load-program-btn" onclick="loadProgram('${log.id}')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Load Program
                            </button>
                            <button class="delete-log-btn" onclick="deleteLog('${log.id}')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                                    <polyline points="3,6 5,6 21,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Delete
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(logEntry);
            });
        }

        // Load program from log
        function loadProgram(logId) {
            const log = JSON.parse(localStorage.getItem(logId));
            if (!log) {
                alert('Program not found.');
                return;
            }

            // Load patient info
            document.getElementById('patientName').value = log.patient.name;

            // Clear current program
            const tbody = document.getElementById('programBody');
            tbody.innerHTML = '';

            // Load exercises
            log.exercises.forEach(exercise => {
                addExerciseToProgram(exercise.name, exercise.setsReps, exercise.notes);
            });

            // Update patient button
            updatePatientButton();
            
            // Close modal
            closePatientsLog();
            
            alert(`Program for ${log.patient.name} loaded successfully!`);
        }

        // Helper function to add exercise to program
        function addExerciseToProgram(exerciseName, setsReps, notes) {
            const tbody = document.getElementById('programBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" value="${exerciseName}" /></td>
                <td><input type="text" value="${setsReps}" /></td>
                <td><input type="text" value="${notes}" placeholder="Add notes..." /></td>
                <td><button class="remove-btn" onclick="removeExercise(this)">Remove</button></td>
            `;
            tbody.appendChild(newRow);
        }

        // Delete log
        function deleteLog(logId) {
            if (confirm('Are you sure you want to delete this program? This action cannot be undone.')) {
                localStorage.removeItem(logId);
                loadAllPatientLogs();
                displayPatientsLog();
                alert('Program deleted successfully.');
            }
        }

        // Filter patients log
        function filterPatientsLog() {
            const searchTerm = document.getElementById('logSearchInput').value.toLowerCase();
            const filtered = allPatientLogs.filter(log => {
                const nameMatch = log.patient.name.toLowerCase().includes(searchTerm);
                const emailMatch = log.patient.email && log.patient.email.toLowerCase().includes(searchTerm);
                const conditionMatch = log.patient.condition && log.patient.condition.toLowerCase().includes(searchTerm);
                return nameMatch || emailMatch || conditionMatch;
            });
            displayPatientsLog(filtered);
        }

        // Sort patients log
        function sortPatientsLog() {
            const sortBy = document.getElementById('logSortSelect').value;
            let sorted = [...allPatientLogs];
            
            switch(sortBy) {
                case 'date-desc':
                    sorted.sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate));
                    break;
                case 'date-asc':
                    sorted.sort((a, b) => new Date(a.createdDate) - new Date(b.createdDate));
                    break;
                case 'name-asc':
                    sorted.sort((a, b) => a.patient.name.localeCompare(b.patient.name));
                    break;
                case 'name-desc':
                    sorted.sort((a, b) => b.patient.name.localeCompare(a.patient.name));
                    break;
            }
            
            displayPatientsLog(sorted);
        }

        // Tab navigation functions
        function showDashboard() {
            document.getElementById('dashboardView').style.display = 'grid';
            document.getElementById('myPatientsView').style.display = 'none';
            
            // Update tab states
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.nav-tab[onclick="showDashboard()"]').classList.add('active');
        }

        function showMyPatients() {
            document.getElementById('dashboardView').style.display = 'none';
            document.getElementById('myPatientsView').style.display = 'block';
            
            // Update tab states
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.nav-tab[onclick="showMyPatients()"]').classList.add('active');
            
            // Load and display patients
            loadAllPatientLogs();
            displayMyPatients();
        }

        // Display patients in My Patients view
        function displayMyPatients(logsToShow = allPatientLogs) {
            const container = document.getElementById('myPatientsContainer');
            
            if (logsToShow.length === 0) {
                container.innerHTML = '<div class="empty-log">No patient programs saved yet.</div>';
                return;
            }

            container.innerHTML = '';
            
            logsToShow.forEach(log => {
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                
                const exercisesHtml = log.exercises.map(exercise => `
                    <div class="log-exercise">
                        <span class="log-exercise-name">${exercise.name}</span>
                        <span class="log-exercise-details">${exercise.setsReps}${exercise.notes ? ' - ' + exercise.notes : ''}</span>
                    </div>
                `).join('');

                logEntry.innerHTML = `
                    <div class="log-entry-header">
                        <div class="log-patient-info">
                            <div class="log-patient-name">${log.patient.name}</div>
                            ${log.patient.email ? `<div class="log-patient-email">${log.patient.email}</div>` : ''}
                            ${log.patient.condition ? `<div class="log-patient-condition">${log.patient.condition}</div>` : ''}
                        </div>
                        <div class="log-date">
                            Created: ${new Date(log.createdDate).toLocaleDateString()}<br>
                            ${new Date(log.createdDate).toLocaleTimeString()}
                        </div>
                    </div>
                    <div class="log-program">
                        <div class="log-program-title">Rehabilitation Program (${log.exercises.length} exercises)</div>
                        <div class="log-exercises">
                            ${exercisesHtml}
                        </div>
                        <div class="log-actions">
                            <button class="load-program-btn" onclick="loadProgramFromPatients('${log.id}')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Load Program
                            </button>
                            <button class="delete-log-btn" onclick="deleteLogFromPatients('${log.id}')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                                    <polyline points="3,6 5,6 21,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Delete
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(logEntry);
            });
        }

        // Load program from My Patients view
        function loadProgramFromPatients(logId) {
            const log = JSON.parse(localStorage.getItem(logId));
            if (!log) {
                alert('Program not found.');
                return;
            }

            // Switch to dashboard view
            showDashboard();

            // Load patient info
            document.getElementById('patientName').value = log.patient.name;

            // Clear current program
            const tbody = document.getElementById('programBody');
            tbody.innerHTML = '';

            // Load exercises
            log.exercises.forEach(exercise => {
                addExerciseToProgram(exercise.name, exercise.setsReps, exercise.notes);
            });

            // Update patient button
            updatePatientButton();
            
            alert(`Program for ${log.patient.name} loaded to dashboard!`);
        }

        // Delete log from My Patients view
        function deleteLogFromPatients(logId) {
            if (confirm('Are you sure you want to delete this program? This action cannot be undone.')) {
                localStorage.removeItem(logId);
                loadAllPatientLogs();
                displayMyPatients();
                alert('Program deleted successfully.');
            }
        }

        // Filter patients in My Patients view
        function filterMyPatients() {
            const searchTerm = document.getElementById('patientsSearchInput').value.toLowerCase();
            const filtered = allPatientLogs.filter(log => {
                const nameMatch = log.patient.name.toLowerCase().includes(searchTerm);
                const emailMatch = log.patient.email && log.patient.email.toLowerCase().includes(searchTerm);
                const conditionMatch = log.patient.condition && log.patient.condition.toLowerCase().includes(searchTerm);
                return nameMatch || emailMatch || conditionMatch;
            });
            displayMyPatients(filtered);
        }

        // Sort patients in My Patients view
        function sortMyPatients() {
            const sortBy = document.getElementById('patientsSortSelect').value;
            let sorted = [...allPatientLogs];
            
            switch(sortBy) {
                case 'date-desc':
                    sorted.sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate));
                    break;
                case 'date-asc':
                    sorted.sort((a, b) => new Date(a.createdDate) - new Date(b.createdDate));
                    break;
                case 'name-asc':
                    sorted.sort((a, b) => a.patient.name.localeCompare(b.patient.name));
                    break;
                case 'name-desc':
                    sorted.sort((a, b) => b.patient.name.localeCompare(a.patient.name));
                    break;
            }
            
            displayMyPatients(sorted);
        }

        // Patient details modal functions
        function openPatientDetails() {
            const patientName = document.getElementById('patientName').value.trim();
            
            if (!patientName) {
                alert('Please enter a patient name first.');
                return;
            }

            // Load existing data if available
            const savedData = localStorage.getItem(`patient_${patientName}`);
            if (savedData) {
                currentPatientData = JSON.parse(savedData);
                populateModal(currentPatientData);
            } else {
                // Clear modal for new patient
                currentPatientData = { name: patientName };
                clearModal();
                document.getElementById('modalPatientName').value = patientName;
            }

            document.getElementById('patientModal').style.display = 'flex';
        }

        function closePatientDetails() {
            document.getElementById('patientModal').style.display = 'none';
        }

        function populateModal(data) {
            document.getElementById('modalPatientName').value = data.name || '';
            document.getElementById('modalPatientEmail').value = data.email || '';
            document.getElementById('modalPatientCondition').value = data.condition || '';
            document.getElementById('modalPatientNotes').value = data.notes || '';
        }

        function clearModal() {
            document.getElementById('modalPatientName').value = '';
            document.getElementById('modalPatientEmail').value = '';
            document.getElementById('modalPatientCondition').value = '';
            document.getElementById('modalPatientNotes').value = '';
        }

        function savePatientDetails() {
            const name = document.getElementById('modalPatientName').value.trim();
            const email = document.getElementById('modalPatientEmail').value.trim();
            const condition = document.getElementById('modalPatientCondition').value;
            const notes = document.getElementById('modalPatientNotes').value.trim();

            if (!name) {
                alert('Please enter a patient name.');
                return;
            }

            const patientData = {
                name: name,
                email: email,
                condition: condition,
                notes: notes,
                lastUpdated: new Date().toISOString()
            };

            // Save to localStorage
            localStorage.setItem(`patient_${name}`, JSON.stringify(patientData));
            
            // Update main form
            document.getElementById('patientName').value = name;
            
            // Update current data
            currentPatientData = patientData;
            
            // Update button appearance
            updatePatientButton();
            
            // Close modal
            closePatientDetails();
            
            alert('Patient details saved successfully!');
        }

        function loadPatientData() {
            const patientName = document.getElementById('patientName').value.trim();
            if (patientName) {
                const savedData = localStorage.getItem(`patient_${patientName}`);
                if (savedData) {
                    currentPatientData = JSON.parse(savedData);
                    updatePatientButton();
                }
            }
        }

        function updatePatientButton() {
            const button = document.querySelector('.patient-details-btn');
            const patientName = document.getElementById('patientName').value.trim();
            
            if (patientName) {
                const savedData = localStorage.getItem(`patient_${patientName}`);
                if (savedData) {
                    button.classList.add('has-data');
                    button.title = 'Patient details saved - Click to edit';
                } else {
                    button.classList.remove('has-data');
                    button.title = 'Add patient details';
                }
            } else {
                button.classList.remove('has-data');
                button.title = 'Enter patient name first';
            }
        }

        // Add event listener to patient name input
        document.addEventListener('DOMContentLoaded', function() {
            const patientNameInput = document.getElementById('patientName');
            if (patientNameInput) {
                patientNameInput.addEventListener('input', function() {
                    setTimeout(updatePatientButton, 100);
                });
                patientNameInput.addEventListener('blur', loadPatientData);
            }
        });

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('patientModal');
            if (event.target === modal) {
                closePatientDetails();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('patientModal');
                if (modal.style.display === 'flex') {
                    closePatientDetails();
                }
            }
        });

        // Display exercises in the library
        function displayExercises(exerciseList) {
            const container = document.getElementById('exerciseList');
            container.innerHTML = '';

            exerciseList.forEach(exercise => {
                const exerciseDiv = document.createElement('div');
                exerciseDiv.className = 'exercise-item';
                exerciseDiv.innerHTML = `
                    <div class="exercise-image-placeholder">${exercise.emoji}</div>
                    <div class="exercise-name">${exercise.name}</div>
                `;
                
                exerciseDiv.addEventListener('click', () => {
                    addToProgram(exercise.name, exercise.defaultSets, exercise.defaultReps);
                });
                
                container.appendChild(exerciseDiv);
            });
        }

        // Filter exercises based on selected criteria
        function filterExercises() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const bodyPart = document.getElementById('bodyPartFilter').value;
            const type = document.getElementById('typeFilter').value;

            let filtered = exercises.filter(exercise => {
                const searchMatch = !searchTerm || exercise.name.toLowerCase().includes(searchTerm);
                const bodyPartMatch = !bodyPart || exercise.bodyPart === bodyPart;
                const typeMatch = !type || exercise.type === type;
                return searchMatch && bodyPartMatch && typeMatch;
            });

            displayExercises(filtered);
        }

        // Add exercise to training program
        function addToProgram(exerciseName, defaultSets, defaultReps) {
            const tbody = document.getElementById('programBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" value="${exerciseName}" /></td>
                <td><input type="text" value="${defaultSets} × ${defaultReps}" /></td>
                <td><input type="text" placeholder="Add notes..." /></td>
                <td><button class="remove-btn" onclick="removeExercise(this)">Remove</button></td>
            `;
            tbody.appendChild(newRow);
        }

        // Remove exercise from program
        function removeExercise(button) {
            button.closest('tr').remove();
        }

        // Generate program with AI (placeholder function)
        function generateProgram() {
            const input = document.getElementById('aiInput').value;
            if (!input.trim()) {
                alert('Please describe the patient condition and requirements first.');
                return;
            }

            // Simulate AI generation with some sample exercises
            const sampleExercises = [
                { name: "Heel Raises", sets: "3", reps: "15" },
                { name: "Single Leg Balance", sets: "3", reps: "30s" },
                { name: "Squats", sets: "3", reps: "12" }
            ];

            // Clear current program
            const tbody = document.getElementById('programBody');
            tbody.innerHTML = '';

            // Add sample exercises
            sampleExercises.forEach(exercise => {
                addToProgram(exercise.name, exercise.sets, exercise.reps);
            });

            alert('AI program generated! Review and modify as needed.');
        }

        // Email program to patient
        function emailProgram() {
            const patientName = document.getElementById('patientName').value;
            
            // Get patient email from saved details
            const savedPatientData = localStorage.getItem(`patient_${patientName}`);
            let patientEmail = '';
            if (savedPatientData) {
                const patientData = JSON.parse(savedPatientData);
                patientEmail = patientData.email || '';
            }
            
            if (!patientName.trim()) {
                alert('Please enter the patient name first.');
                return;
            }
            
            if (!patientEmail.trim()) {
                alert('Please add patient email in patient details first.');
                return;
            }

            const tbody = document.getElementById('programBody');
            const exercises = tbody.querySelectorAll('tr');
            
            if (exercises.length === 0) {
                alert('Please add exercises to the program before emailing.');
                return;
            }

            // Create email content
            let emailBody = `Dear ${patientName},\n\nHere is your personalized rehabilitation program:\n\n`;
            
            exercises.forEach((row, index) => {
                const exerciseName = row.cells[0].querySelector('input').value;
                const setsReps = row.cells[1].querySelector('input').value;
                const notes = row.cells[2].querySelector('input').value;
                
                emailBody += `${index + 1}. ${exerciseName} - ${setsReps}`;
                if (notes.trim()) {
                    emailBody += ` (${notes})`;
                }
                emailBody += '\n';
            });
            
            emailBody += '\nBest regards,\nYour Physical Therapy Team';

            // Create mailto link
            const subject = `Your Rehabilitation Program - ${patientName}`;
            const mailtoLink = `mailto:${patientEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;
            
            // Open default email client
            window.location.href = mailtoLink;
        }

        // Print program
        function printProgram() {
            window.print();
        }

        // Template selector functions
        function openTemplateSelector() {
            document.getElementById('templateModal').style.display = 'flex';
        }

        function closeTemplateSelector() {
            document.getElementById('templateModal').style.display = 'none';
        }

        function selectTemplate(templateType) {
            // Remove selected class from all templates
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selected class to clicked template
            event.target.closest('.template-card').classList.add('selected');
            
            // Store selected template type
            document.getElementById('templateModal').setAttribute('data-selected', templateType);
            
            // If post-surgical template is selected, show the detailed form
            if (templateType === 'postsurgical') {
                closeTemplateSelector();
                setTimeout(() => openPostSurgicalForm(), 200);
            }
        }

        function applyTemplate() {
            const selectedTemplate = document.getElementById('templateModal').getAttribute('data-selected');
            
            if (!selectedTemplate) {
                alert('Please select a template first.');
                return;
            }

            // Clear current program
            const tbody = document.getElementById('programBody');
            tbody.innerHTML = '';

            // Define template-specific exercises
            const templateExercises = {
                'standard': [
                    { name: "Range of Motion Assessment", sets: "1", reps: "Full ROM" },
                    { name: "Pain Scale Documentation", sets: "Daily", reps: "1-10 scale" },
                    { name: "Basic Strengthening", sets: "3", reps: "15" },
                    { name: "Flexibility Exercises", sets: "3", reps: "30s hold" },
                    { name: "Weekly Progress Review", sets: "Weekly", reps: "Assessment" }
                ],
                'quick': [
                    { name: "Simple Movement Exercises", sets: "2", reps: "10" },
                    { name: "Basic Stretching", sets: "2", reps: "20s hold" },
                    { name: "Core Strengthening", sets: "2", reps: "12" }
                ],
                'performance': [
                    { name: "Strength Testing", sets: "3", reps: "Max effort" },
                    { name: "Power Measurement", sets: "5", reps: "Explosive" },
                    { name: "Endurance Assessment", sets: "1", reps: "Time to fatigue" },
                    { name: "Functional Movement Screen", sets: "1", reps: "Complete battery" },
                    { name: "Sport-Specific Drills", sets: "4", reps: "Varied" }
                ],
                'home': [
                    { name: "Bodyweight Exercises", sets: "3", reps: "15" },
                    { name: "Resistance Band Work", sets: "3", reps: "12" },
                    { name: "Balance Training", sets: "3", reps: "30s" },
                    { name: "Daily Activity Integration", sets: "Throughout day", reps: "As needed" }
                ],
                'postsurgical': [
                    { name: "Phase 1: Protection", sets: "Weeks 1-2", reps: "Gentle ROM" },
                    { name: "Phase 2: Early Mobility", sets: "Weeks 3-6", reps: "Progressive" },
                    { name: "Phase 3: Strengthening", sets: "Weeks 6-12", reps: "Gradual load" },
                    { name: "Wound Care Monitoring", sets: "Daily", reps: "Visual check" },
                    { name: "MD Communication Log", sets: "Weekly", reps: "Status update" }
                ],
                'custom': [
                    { name: "Define Your Exercise 1", sets: "3", reps: "12" },
                    { name: "Define Your Exercise 2", sets: "3", reps: "15" },
                    { name: "Define Your Exercise 3", sets: "2", reps: "10" }
                ]
            };

            // Add template exercises to program
            const exercises = templateExercises[selectedTemplate] || templateExercises['custom'];
            exercises.forEach(exercise => {
                addToProgram(exercise.name, exercise.sets, exercise.reps);
            });

            // Close modal
            closeTemplateSelector();
            
            // Show confirmation
            const templateNames = {
                'standard': 'Standard Rehab',
                'quick': 'Quick Protocol',
                'performance': 'Performance Tracking',
                'home': 'Home Exercise Program',
                'postsurgical': 'Post-Surgical',
                'custom': 'Custom Template'
            };
            
            alert(`${templateNames[selectedTemplate]} template applied successfully!`);
        }

        // Close template modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('templateModal');
            if (event.target === modal) {
                closeTemplateSelector();
            }
        });

        // Close template modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('templateModal');
                if (modal.style.display === 'flex') {
                    closeTemplateSelector();
                }
                const postSurgicalModal = document.getElementById('postSurgicalModal');
                if (postSurgicalModal.style.display === 'flex') {
                    closePostSurgicalForm();
                }
            }
        });

        // Post-Surgical Form Functions
        function openPostSurgicalForm() {
            document.getElementById('postSurgicalModal').style.display = 'flex';
        }

        function closePostSurgicalForm() {
            document.getElementById('postSurgicalModal').style.display = 'none';
        }

        // Variable to track current template type
        let currentTemplateType = 'default';

        // Function to update the training program table structure based on template type
        function updateTrainingProgramTable(templateType) {
            const table = document.getElementById('programTable');
            const thead = table.querySelector('thead tr');
            
            // Clear existing headers
            thead.innerHTML = '';
            
            if (templateType === 'postsurgical') {
                // Post-surgical template with comprehensive parameters
                thead.innerHTML = `
                    <th>Exercise</th>
                    <th>Parameters</th>
                    <th>Frequency</th>
                    <th>Pain Level</th>
                    <th>Clinical Notes</th>
                    <th>Monitoring</th>
                    <th>Action</th>
                `;
            } else {
                // Default template structure
                thead.innerHTML = `
                    <th>Exercise</th>
                    <th>Sets × Reps</th>
                    <th>Notes</th>
                    <th>Action</th>
                `;
            }
        }

        // Function to add surgery info header to the program
        function addSurgeryInfoHeader(surgeryType, surgeryDate, surgeonName, graftType) {
            const tbody = document.getElementById('programBody');
            
            // Create surgery info row
            const surgeryRow = document.createElement('tr');
            surgeryRow.style.backgroundColor = 'rgba(52, 152, 219, 0.2)';
            surgeryRow.style.borderLeft = '4px solid rgba(52, 152, 219, 0.8)';
            
            const colSpan = currentTemplateType === 'postsurgical' ? 7 : 4;
            surgeryRow.innerHTML = `
                <td colspan="${colSpan}" style="padding: 15px; font-weight: 600; color: white;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M19 3H5C3.89 3 3 3.89 3 5V19C3 20.11 3.89 21 5 21H19C20.11 21 21 20.11 21 19V5C21 3.89 20.11 3 19 3Z" stroke="white" stroke-width="2"/>
                            <path d="M9 9H15M9 13H15M9 17H13" stroke="white" stroke-width="2"/>
                        </svg>
                        <strong>Surgery Information:</strong> ${surgeryType} | Date: ${surgeryDate} | Surgeon: ${surgeonName}${graftType ? ' | Graft: ' + graftType : ''}
                    </div>
                </td>
            `;
            
            tbody.insertBefore(surgeryRow, tbody.firstChild);
        }

        // Function to add post-surgical exercises with comprehensive parameters
        function addPostSurgicalExercise(exercise) {
            const tbody = document.getElementById('programBody');
            const row = document.createElement('tr');
            row.style.transition = 'all 0.3s ease';
            
            row.innerHTML = `
                <td style="font-weight: 500; color: white;">
                    ${exercise.exercise}
                </td>
                <td style="color: rgba(255, 255, 255, 0.9);">
                    ${exercise.parameters}
                </td>
                <td style="color: rgba(255, 255, 255, 0.9);">
                    ${exercise.frequency}
                </td>
                <td style="color: rgba(255, 255, 255, 0.9);">
                    ${exercise.painLevel}
                </td>
                <td style="color: rgba(255, 255, 255, 0.8); font-size: 13px; max-width: 200px;">
                    ${exercise.clinicalNotes}
                </td>
                <td style="color: rgba(255, 255, 255, 0.8); font-size: 13px; max-width: 200px;">
                    ${exercise.monitoring}
                </td>
                <td>
                    <button class="remove-exercise-btn" onclick="removeExercise(this)" style="background: rgba(231, 76, 60, 0.7); border: 1px solid rgba(231, 76, 60, 0.8); color: white; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.3s ease;">
                        Remove
                    </button>
                </td>
            `;
            
            tbody.appendChild(row);
        }

        function applyPostSurgicalTemplate() {
            // Get form data
            const surgeryType = document.getElementById('surgeryType').value;
            const surgeryDate = document.getElementById('surgeryDate').value;
            const surgeonName = document.getElementById('surgeonName').value;
            const graftType = document.getElementById('graftType').value;

            // Validate required fields
            if (!surgeryType || !surgeryDate || !surgeonName) {
                alert('Please fill in all required fields (Surgery, Date, Surgeon).');
                return;
            }

            // Set template type and update table structure
            currentTemplateType = 'postsurgical';
            updateTrainingProgramTable('postsurgical');

            // Create comprehensive post-surgical program based on form data
            const postSurgicalExercises = [
                {
                    exercise: "Heel Slides (Supine, towel assist)",
                    parameters: "3 × 15 reps",
                    frequency: "Every 2 hours",
                    painLevel: "< 3/10",
                    clinicalNotes: "Use towel for assistance, stop at first resistance, ice after exercise",
                    monitoring: "Current ROM: ___°, Pain: ___/10, Swelling: +___, Quality: ___"
                },
                {
                    exercise: "Ankle Pumps",
                    parameters: "3 × 20 reps",
                    frequency: "Hourly while awake",
                    painLevel: "< 2/10",
                    clinicalNotes: "Maintain dorsiflexion/plantarflexion range, prevent DVT",
                    monitoring: "Circulation check, calf tenderness assessment"
                },
                {
                    exercise: "Quad Sets (isometric)",
                    parameters: "3 × 10 reps",
                    frequency: "4x daily",
                    painLevel: "< 4/10",
                    clinicalNotes: "Hold 5 sec, focus on VMO activation",
                    monitoring: "Muscle activation quality, strength progression"
                },
                {
                    exercise: "ROM Monitoring & Documentation",
                    parameters: "Daily assessment",
                    frequency: "Each session",
                    painLevel: "< 3/10",
                    clinicalNotes: "Document end-range achieved, note restrictions",
                    monitoring: "Goal: 0-90° by week 2, track weekly progress"
                },
                {
                    exercise: "Wound Care & Red Flag Monitoring",
                    parameters: "Daily inspection",
                    frequency: "Each visit",
                    painLevel: "Monitor for increases",
                    clinicalNotes: "Check incision, drainage, temperature < 100.4°F",
                    monitoring: "Incision status, drainage amount/color, temperature"
                }
            ];

            // Clear current program and add new exercises
            const tbody = document.getElementById('programBody');
            tbody.innerHTML = '';
            
            postSurgicalExercises.forEach(exercise => {
                addPostSurgicalExercise(exercise);
            });

            // Add surgery info header to the program
            addSurgeryInfoHeader(surgeryType, surgeryDate, surgeonName, graftType);

            // Close modal
            closePostSurgicalForm();

            // Show confirmation with surgery details
            alert(`Post-Surgical Protocol Generated!\n\nSurgery: ${surgeryType}\nSurgeon: ${surgeonName}\nDate: ${surgeryDate}\n${graftType ? 'Graft: ' + graftType : ''}\n\nPhase 1 protocol has been added to your training program.`);
        }

        // Close post-surgical modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('postSurgicalModal');
            if (event.target === modal) {
                closePostSurgicalForm();
            }
        });

        // Initialize the page when loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>